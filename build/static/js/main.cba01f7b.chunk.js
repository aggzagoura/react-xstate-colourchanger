(this["webpackJsonpxstate-react-typescript-template"]=this["webpackJsonpxstate-react-typescript-template"]||[]).push([[0],{23:function(t,e,n){},40:function(t,e,n){"use strict";n.r(e);var o=n(27),c=n(6),a=(n(23),n(8),n(24)),r=n(20),i=n(2),s=n(44),u=n(43),p=n(12).a.cancel;function l(t){return Object(i.q)((function(e){return{type:"SPEAK",value:t}}))}function m(){return Object(i.q)("LISTEN")}function d(t,e){return{entry:l(t),on:{ENDSPEECH:e+".hist"}}}function h(t){return{entry:l(t),on:{ENDSPEECH:"ask"}}}var E={John:{person:"John Appleseed"},Mary:{person:"Mary Zagoura"},Nick:{person:"Nick Katapodis"},Samantha:{person:"Samantha Meyers"},Anna:{person:"Anna Heathrow"},James:{person:"James Smith"},"on Friday":{day:"Friday"},"on Monday":{day:"Monday"},"on Tuesday":{day:"Tuesday"},"on Saturday":{day:"Saturday"},"at ten":{time:"10:00"},"at 10":{time:"10:00"},"at eight":{time:"8:00"},"at 8":{time:"8:00"},"at eleven":{time:"11:00"},"at 11":{time:"11:00"},"at twelve":{time:"12:00"},"at 12":{time:"12:00"}},b={yes:!0,Yes:!0,"Of course":!0,"of course":!0,No:!1,no:!1,"No way":!1,"no way":!1},y={help:"h",Help:"H"},f={count:0},O={initial:"init",states:{init:{on:{CLICK:"welcome"}},welcome:{initial:"prompt",on:{RECOGNISED:[{target:"query",cond:function(t){return!(t.recResult in y)},actions:[Object(i.b)((function(t){return{option:t.recResult}})),Object(i.b)((function(t){f.count=0}))]},{target:"helpA",cond:function(t){return t.recResult in y}}],MAXSPEECH:[{target:".maxspeech",cond:function(t){return f.count<=2},actions:Object(i.b)((function(t){f.count=f.count+1}))},{target:"#root.dm.init",cond:function(t){return f.count>2},actions:Object(i.b)((function(t){f.count=0}))}]},states:{prompt:{entry:l("What do you want to do?"),on:{ENDSPEECH:"ask"}},hist:{type:"history"},maxspeech:Object(c.a)({},h("I didn't get a respond\uff0cplease repeat")),ask:{entry:[m(),Object(i.q)("MAXSPEECH",{delay:5e3})]}}},helpA:Object(c.a)({},d("Please tell me what you want to do","welcome")),query:{invoke:{id:"rasa",src:function(t,e){return g(t.option)},onDone:{target:"menu",actions:[Object(i.b)((function(t,e){return{option:e.data.intent.name}})),function(t,e){return console.log(e.data)}]},onError:{target:"welcome",actions:function(t,e){return console.log(e.data)}}}},menu:{initial:"prompt",on:{ENDSPEECH:[{target:"todo",cond:function(t){return"todo"===t.option}},{target:"timer",cond:function(t){return"timer"===t.option}},{target:"appointment",cond:function(t){return"appointment"===t.option}}]},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"OK. I see\uff0cyou want a ".concat(t.option,".")}}))}}},todo:{initial:"prompt",on:{ENDSPEECH:"init"},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Let's create a to do item"}}))}}},timer:{initial:"prompt",on:{ENDSPEECH:"init"},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Let's create a timer"}}))}}},appointment:{initial:"prompt",on:{ENDSPEECH:"who"},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Let's make an appointment"}}))}}},who:{initial:"prompt",on:{RECOGNISED:[{cond:function(t){return"person"in(E[t.recResult]||{})},actions:[Object(i.b)((function(t){return{person:E[t.recResult].person}})),Object(i.b)((function(t){f.count=0})),p("maxsp")],target:"day"},{target:".nomatch",cond:function(t){return!(t.recResult in y)},actions:p("maxsp")},{target:"helpB",cond:function(t){return t.recResult in y}}],MAXSPEECH:[{target:".maxspeech",cond:function(t){return f.count<=2},actions:Object(i.b)((function(t){f.count=f.count+1}))},{target:"#root.dm.init",cond:function(t){return f.count>2},actions:Object(i.b)((function(t){f.count=0}))}]},states:{prompt:{entry:l("Who are you meeting with?"),on:{ENDSPEECH:"ask"}},hist:{type:"history"},ask:{entry:[m(),Object(i.q)("MAXSPEECH",{delay:5e3,id:"maxsp"})]},maxspeech:Object(c.a)({},h("I didn't get a respond, please tell me the person")),nomatch:{entry:l("Sorry I'm not aware of this name"),on:{ENDSPEECH:"prompt"}}}},helpB:Object(c.a)({},d("Please tell me the name","who")),day:{initial:"prompt",on:{RECOGNISED:[{cond:function(t){return"day"in(E[t.recResult]||{})},actions:[Object(i.b)((function(t){return{day:E[t.recResult].day}})),Object(i.b)((function(t){f.count=0})),p("maxsp")],target:"wholeday"},{target:".nomatch",cond:function(t){return!(t.recResult in y)},actions:p("maxsp")},{target:"helpC",cond:function(t){return t.recResult in y}}],MAXSPEECH:[{target:".maxspeech",cond:function(t){return f.count<=2},actions:Object(i.b)((function(t){f.count=f.count+1}))},{target:"#root.dm.init",cond:function(t){return f.count>2},actions:Object(i.b)((function(t){f.count=0}))}]},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"OK. ".concat(t.person,". On which day is your meeting?")}})),on:{ENDSPEECH:"ask"}},hist:{type:"history"},ask:{entry:[m(),Object(i.q)("MAXSPEECH",{delay:5e3,id:"maxsp"})]},maxspeech:Object(c.a)({},h("I didn't get a respond, please say a day")),nomatch:{entry:l("Sorry I don't recognise the day you are telling me"),on:{ENDSPEECH:"prompt"}}}},helpC:Object(c.a)({},d("Please tell me the day","day")),wholeday:{initial:"prompt",on:{RECOGNISED:[{cond:function(t){return!0===b[t.recResult]},target:"notime",actions:[Object(i.b)((function(t){f.count=0})),p("maxsp")]},{cond:function(t){return!1===b[t.recResult]},target:"whattime",actions:[Object(i.b)((function(t){f.count=0})),p("maxsp")]},{target:".nomatch",cond:function(t){return!(t.recResult in y)},actions:p("maxsp")},{target:"helpD",cond:function(t){return t.recResult in y}}],MAXSPEECH:[{target:".maxspeech",cond:function(t){return f.count<=2},actions:Object(i.b)((function(t){f.count=f.count+1}))},{target:"#root.dm.init",cond:function(t){return f.count>2},actions:Object(i.b)((function(t){f.count=0}))}]},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Good.on ".concat(t.day,". Will it take the whole day?")}})),on:{ENDSPEECH:"ask"}},hist:{type:"history"},ask:{entry:[m(),Object(i.q)("MAXSPEECH",{delay:5e3,id:"maxsp"})]},maxspeech:Object(c.a)({},h("You did not respond, say a decision")),nomatch:{entry:l("Could you please repeat"),on:{ENDSPEECH:"prompt"}}}},helpD:Object(c.a)({},d("Please tell me your decision","wholeday")),notime:{initial:"prompt",on:{RECOGNISED:[{cond:function(t){return!0===b[t.recResult]},target:"Finished",actions:[Object(i.b)((function(t){f.count=0})),p("maxsp")]},{cond:function(t){return!1===b[t.recResult]},target:"who",actions:[Object(i.b)((function(t){f.count=0})),p("maxsp")]},{target:".nomatch",cond:function(t){return!(t.recResult in y)},actions:p("maxsp")},{target:"helpE",cond:function(t){return t.recResult in y}}],MAXSPEECH:[{target:".maxspeech",cond:function(t){return f.count<=2},actions:Object(i.b)((function(t){f.count=f.count+1}))},{target:"#root.dm.init",cond:function(t){return f.count>2},actions:Object(i.b)((function(t){f.count=0}))}]},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Good. Do you want to me create an appointment with ".concat(t.person," on ").concat(t.day,"for the whole day?")}})),on:{ENDSPEECH:"ask"}},hist:{type:"history"},ask:{entry:[m(),Object(i.q)("MAXSPEECH",{delay:5e3,id:"maxsp"})]},maxspeech:Object(c.a)({},h("I didn't get a respond, please confirm it")),nomatch:{entry:l("Please repeat"),on:{ENDSPEECH:"prompt"}}}},helpE:Object(c.a)({},d("Please confirm it","notime")),whattime:{initial:"prompt",on:{RECOGNISED:[{cond:function(t){return"time"in(E[t.recResult]||{})},actions:[Object(i.b)((function(t){return{time:E[t.recResult].time}})),Object(i.b)((function(t){f.count=0}))],target:"withtime"},{target:".nomatch",cond:function(t){return!(t.recResult in y)},actions:p("maxsp")},{target:"helpF",cond:function(t){return t.recResult in y}}],MAXSPEECH:[{target:".maxspeech",cond:function(t){return f.count<=2},actions:Object(i.b)((function(t){f.count=f.count+1}))},{target:"#root.dm.init",cond:function(t){return f.count>2},actions:Object(i.b)((function(t){f.count=0}))}]},states:{prompt:{entry:l("What time is your meeting"),on:{ENDSPEECH:"ask"}},hist:{type:"history"},ask:{entry:[m(),Object(i.q)("MAXSPEECH",{delay:5e3,id:"maxsp"})]},maxspeech:Object(c.a)({},h("I didn't get a respond, please say a time")),nomatch:{entry:l("Please repeat"),on:{ENDSPEECH:"prompt"}}}},helpF:Object(c.a)({},d("Please tell me the time","whattime")),withtime:{initial:"prompt",on:{RECOGNISED:[{cond:function(t){return!0===b[t.recResult]},target:"Finished",actions:Object(i.b)((function(t){f.count=0}))},{cond:function(t){return!1===b[t.recResult]},target:"who",actions:[Object(i.b)((function(t){f.count=0})),p("maxsp")]},{target:".nomatch",cond:function(t){return!(t.recResult in y)},actions:p("maxsp")},{target:"helpG",cond:function(t){return t.recResult in y}}],MAXSPEECH:[{target:".maxspeech",cond:function(t){return f.count<=2},actions:Object(i.b)((function(t){f.count=f.count+1}))},{target:"#root.dm.init",cond:function(t){return f.count>2},actions:Object(i.b)((function(t){f.count=0}))}]},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Good. Do you want to make an appointment with ".concat(t.person," on ").concat(t.day," at ").concat(t.time,"?")}})),on:{ENDSPEECH:"ask"}},hist:{type:"history"},ask:{entry:[m(),Object(i.q)("MAXSPEECH",{delay:5e3,id:"maxsp"})]},maxspeech:Object(c.a)({},h("I didn't get a respond, please confirm it")),nomatch:{entry:l("Please repeat"),on:{ENDSPEECH:"prompt"}}}},helpG:Object(c.a)({},d("Please confirm it","withtime")),Finished:{initial:"prompt",on:{ENDSPEECH:"init"},states:{prompt:{entry:l("Your appointment has been created successfully!")}}}}},g=function(t){return fetch(new Request("https://cors-anywhere.herokuapp.com/https://rasa-nlu-app.herokuapp.com/model/parse",{method:"POST",headers:{Origin:"http://localhost:3000/react-xstate-colourchanger"},body:'{"text": "'.concat(t,'"}')})).then((function(t){return t.json()}))},j=n(22),S=n(13);Object(u.a)({url:"https://statecharts.io/inspect",iframe:!1});var P=Object(r.a)({id:"root",type:"parallel",states:{dm:Object(c.a)({},O),asrtts:{initial:"idle",states:{idle:{on:{LISTEN:"recognising",SPEAK:{target:"speaking",actions:Object(i.b)((function(t,e){return{ttsAgenda:e.value}}))}}},recognising:{initial:"progress",entry:"recStart",exit:"recStop",on:{ASRRESULT:{actions:["recLogResult",Object(i.b)((function(t,e){return{recResult:e.value}}))],target:".match"},RECOGNISED:"idle",MAXSPEECH:"idle"},states:{progress:{},match:{entry:Object(i.q)("RECOGNISED")}}},speaking:{entry:"ttsStart",on:{ENDSPEECH:"idle"}}}}}},{actions:{recLogResult:function(t){console.log("<< ASR: "+t.recResult)},test:function(){console.log("test")},logIntent:function(t){console.log("<< NLU intent: "+t.nluData.intent.name)}}}),C=function(t){switch(!0){case t.state.matches({asrtts:"recognising"}):return Object(S.jsx)("button",Object(c.a)(Object(c.a)({type:"button",className:"glow-on-hover",style:{animation:"glowing 20s linear"}},t),{},{children:"Listening..."}));case t.state.matches({asrtts:"speaking"}):return Object(S.jsx)("button",Object(c.a)(Object(c.a)({type:"button",className:"glow-on-hover",style:{animation:"bordering 1s infinite"}},t),{},{children:"Speaking..."}));default:return Object(S.jsx)("button",Object(c.a)(Object(c.a)({type:"button",className:"glow-on-hover"},t),{},{children:"Click to start"}))}};function R(){var t=Object(j.useSpeechSynthesis)({onEnd:function(){l("ENDSPEECH")}}),e=t.speak,n=t.cancel,c=(t.speaking,Object(j.useSpeechRecognition)({onResult:function(t){l({type:"ASRRESULT",value:t})}})),a=c.listen,r=(c.listening,c.stop),i=Object(s.b)(P,{devTools:!0,actions:{recStart:Object(s.a)((function(){console.log("Ready to receive a color command."),a({interimResults:!1,continuous:!0})})),recStop:Object(s.a)((function(){console.log("Recognition stopped."),r()})),changeColour:Object(s.a)((function(t){console.log("Repainting..."),document.body.style.background=t.recResult})),ttsStart:Object(s.a)((function(t,n){console.log("Speaking..."),e({text:t.ttsAgenda})})),ttsCancel:Object(s.a)((function(t,e){console.log("TTS STOP..."),n()}))}}),u=Object(o.a)(i,3),p=u[0],l=u[1];u[2];return Object(S.jsx)("div",{className:"App",children:Object(S.jsx)(C,{state:p,onClick:function(){return l("CLICK")}})})}var x=document.getElementById("root");a.render(Object(S.jsx)(R,{}),x)}},[[40,1,2]]]);
//# sourceMappingURL=main.cba01f7b.chunk.js.map